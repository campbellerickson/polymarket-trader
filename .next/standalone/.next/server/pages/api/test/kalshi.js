"use strict";(()=>{var e={};e.id=474,e.ids=[474],e.modules={358:e=>{e.exports=require("kalshi-typescript")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},9926:e=>{e.exports=import("zod")},3284:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>c,default:()=>u,routeModule:()=>l});var r=t(1802),o=t(7153),i=t(6249),n=t(7544),d=e([n]);n=(d.then?(await d)():d)[0];let u=(0,i.l)(n,"default"),c=(0,i.l)(n,"config"),l=new r.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/test/kalshi",pathname:"/api/test/kalshi",bundlePath:"",filename:""},userland:n});a()}catch(e){a(e)}})},7544:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>i});var r=t(913),o=e([r]);async function i(e,s){if(e.headers.authorization!==`Bearer ${process.env.CRON_SECRET}`)return s.status(401).json({error:"Unauthorized"});process.env.DEBUG_AUTH="true";let t={timestamp:new Date().toISOString(),tests:{},summary:{passed:0,failed:0,errors:[]}};try{console.log("\uD83E\uDDEA Test 1: Fetching account balance...");try{let e=await (0,r.Et)();t.tests.accountBalance={passed:!0,balance:e,message:`Account balance: $${e.toFixed(2)}`},t.summary.passed++}catch(e){t.tests.accountBalance={passed:!1,error:e.message},t.summary.failed++,t.summary.errors.push(`Account Balance: ${e.message}`)}console.log("\uD83E\uDDEA Test 2: Fetching all markets with pagination...");try{let e=await (0,r.mR)();if(t.tests.fetchMarkets={passed:!0,totalMarkets:e.length,sampleMarket:e.length>0?{market_id:e[0].market_id,question:e[0].question.substring(0,100),yes_odds:e[0].yes_odds,end_date:e[0].end_date}:null,message:`Fetched ${e.length} markets`},t.summary.passed++,e.length>0){console.log("\uD83E\uDDEA Test 3: Filtering for high-conviction markets (>85% or <15%)...");let s=e.filter(e=>{let s=100*e.yes_odds;return s>=85||s<=15});if(t.tests.filterHighConviction={passed:!0,totalMarkets:e.length,highConvictionCount:s.length,highConvictionSample:s.slice(0,3).map(e=>({market_id:e.market_id,question:e.question.substring(0,80),yes_odds:e.yes_odds,yes_price_cents:Math.round(100*e.yes_odds)})),message:`Found ${s.length} high-conviction markets out of ${e.length} total`},t.summary.passed++,s.length>0){console.log("\uD83E\uDDEA Test 4: Testing orderbook enrichment...");let e=s[0];try{let{orderbook:s,liquidity:a,side:o}=await (0,r.Z9)(e.market_id);t.tests.orderbookEnrichment={passed:!0,market_id:e.market_id,liquidity:a,side:o,orderbook:{bestYesBid:s.bestYesBid,bestYesAsk:s.bestYesAsk,bestNoBid:s.bestNoBid,bestNoAsk:s.bestNoAsk},message:`Orderbook fetched successfully. Liquidity: ${a} contracts (${o} side)`},t.summary.passed++}catch(s){t.tests.orderbookEnrichment={passed:!1,market_id:e.market_id,error:s.message},t.summary.failed++,t.summary.errors.push(`Orderbook Enrichment: ${s.message}`)}}else t.tests.orderbookEnrichment={passed:!1,message:"Skipped: No high-conviction markets to test orderbook"}}}catch(e){t.tests.fetchMarkets={passed:!1,error:e.message},t.summary.failed++,t.summary.errors.push(`Fetch Markets: ${e.message}`)}return t.status=0===t.summary.failed?"PASSED":"PARTIAL",0===t.summary.passed&&(t.status="FAILED"),s.status(200).json(t)}catch(e){return console.error("Kalshi API test error:",e),s.status(500).json({status:"FAILED",error:e.message,stack:void 0})}}r=(o.then?(await o)():o)[0],a()}catch(e){a(e)}})}};var s=require("../../../webpack-api-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[947],()=>t(3284));module.exports=a})();